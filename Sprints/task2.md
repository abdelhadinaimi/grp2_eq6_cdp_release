# Tâches pour le Sprint 2

| ID | Description | *Definition of Done* | Dépendance(s) | US liée(s) | Coût (j/h) | Affectée à | État |
| -- | -- | -- | :-: | :-: | :-: | :-: | :-: |
| T_ACC_V | Créer la vue de la page “Mon compte”. | Créer le fichier **account.ejs** dans le répertoire */views/user/* qui correspond à la page "Mon compte", affichée lorsque l'utilisateur arrive sur l'URL */account*.<br />Cette page importe le header **menu-connected.ejs** de */views/partials/*.<br />En dessous de ce header, on trouve un formulaire composé des champs “Adresse mail” (name : “email”), “Nom d’utilisateur” (name : “username”) et “Mot de Passe” (name : “password”) (cf. tâche T_REG_V pour les spécifications), ainsi que de deux boutons "Sauvegarder" et “Annuler”.<br /> En cliquant sur "Sauvegarder", on appelle la route */account* en méthode POST.<br />En cliquant sur "Annuler", on redirige l’utilisateur vers l’URL */*.<br />Créer la route **/account** dans le fichier **/routes/user.routes.js**, méthode GET, qui fait le rendu de cette vue. | - | US#04 | 1 | Abdelhadi | DONE |
| T_ACC_RpoC | Créer la route et la fonction permettant de modifier les informations du compte utilisateur. | Créer la route **/account** dans le fichier **/routes/user.routes.js**, méthode POST, créer la fonction postAccount() dans le contrôleur /controllers/user.controller.js, accepte un formulaire qui contient “email” (adresse mail au format valide), “username” (même validation que dans la vue) et “password” (même validation que dans la vue), appelle la méthode *updateUser(user)* de l’objet */repositories/user.repository.js*, et fait un catch des erreurs. S’il y a une erreur, on fait un render du formulaire et on affiche les erreurs dans le formulaire ; sinon, on affiche “Utilisateur modifié !”. | T_ACC_V | US#04 | 0.5 | Abdelhadi | DONE |
| T_INV_V | Créer le modal pour “Inviter un contributeur”. | Créer le fichier **invite.ejs** dans le dossier **/views/project/**, qui correspond au modal, permettant d'ajouter un contributeur, affiché lorsque l’utilisateur (PO ou CP) clique sur le bouton permettant d'ajouter un contributeur sur la page générale du projet.<br />Ce modal comporte un formulaire avec les champs “Adresse mail” (name : “email”) et “Nom d’utilisateur” (name : “username”), ainsi que deux boutons “Ajouter” et “Annuler”.<br>En cliquant sur “Ajouter”, on appelle la route */invite* en méthode POST.<br>Il est impossible de cliquer si au moins un des deux champs n’a pas été rempli.<br>En cliquant sur "Annuler", on ferme le modal.| - | US#10 | 0.5 | Latappy | DONE |
| T_INV_RpoC | Créer la route et la fonction permettant d’envoyer un mail à un utilisateur que l’on souhaite ajouter au projet.. | Créer la route **/invite** dans le fichier **/routes/project.routes.js**, méthode POST, créer la fonction postInvite() dans le contrôleur /controllers/project.controller.js, accepte un formulaire qui contient “email” (même validation que dans la vue) et/ou “username” (même validation que dans la vue), et qui envoie un mail contenant le lien d’invitation au mail précisé. S’il y a une erreur, on fait un render du formulaire et on affiche les erreurs dans le formulaire ; sinon, on affiche “Invitation envoyée !”. | T_INV_V | US#10,13 | 0.5 | Latappy | DONE |
| T_ROLE_V | Ajouter une liste déroulante à chaque contributeur de la page “Accueil Projet” permettant de changer le rôle d’un collaborateur. | Modifier le fichier **project.ejs** du répertoire */views/project/* pour ajouter une liste déroulante devant le nom d’un collaborateur pour changer son rôle (“Développeur”, “Chef de Projet”), appel la route */projects/:projectId/:userId/role* en méthode PUT avec en paramètre son rôle.| - | US#11 | 0.5 | Martin-Vigier | DOING |
| T_ROLE_RpuC |  Créer la route et la fonction permettant de mettre à jour le rôle d’un contributeur. | Créer la route **/projects/:projectId/:userId/role** dans le fichier **/routes/project.routes.js**, méthode PUT. Puis créer la fonction *updateRole()* dans le contrôleur “/controllers/project.controller.js” qui accepte un formulaire qui contient le rôle de l’utilisateur, appelle la fonction *updateUserRole(projectId,userId,role)* du fichier **/repositories/projects.repository.js**, si une erreur se passe, affiche l’erreur dans le formulaire. | - | US#11 | 0.5 | Abdelhadi | DONE |
| T_COLL_DLT_V | Ajouter un bouton à la page “Accueil Projet” permettant de retirer un utilisateur d’un projet. | Modifier le fichier **project.ejs** du répertoire */views/project/* en ajoutant un bouton “Supprimer” à côté de chaque collaborateur. En appuyant sur ce bouton, un modal de confirmation s’affiche demandant si l’on veut vraiment le supprimer. Si on appuie sur “Annuler” le modal se ferme, si on fait “Valider” le collaborateur est supprimé du projet. | - | US#12 | 0.5 | Latappy | TODO |
| T_USR_DLT_RdC | Créer la route permettant de retirer un utilisateur d’un projet. | Créer la route **/projects/:projectId/:userId** dans le fichier **/routes/project.routes.js**, méthode DELETE. Puis créer la fonction *deleteUser()* dans le contrôleur “/controllers/project.controller.js” qui accepte un formulaire qui contient l’id de l’utilisateur à retirer, appelle la fonction deleteUser(userId) du fichier **/repositories/projects.repository.js**. | - | US#12 | 0.5 | Latappy | TODO |
| T_COLL_ADD_V | Ajouter un toast indiquant à l’utilisateur que celui-ci a bien été ajouté au projet. | Modifier le fichier **project.ejs** du répertoire */views/project/* en ajoutant un toast “Vous êtes désormais contributeur de ce projet !” lorsque l’utilisateur a cliqué sur l’invitation reçue par mail et a été redirigé sur cette page. | - | US#13 | 0.5 | Martin-Vigier | TODO |
| T_COLL_ADD_RgC | Créer la route permettant d’ajouter un utilisateur à un projet. | Créer la route **/projects/:projectId/:userId** dans le fichier **/routes/project.routes.js**, méthode GET. Puis créer la fonction *getAddUser()* dans le contrôleur “/controllers/project.controller.js” qui récupère l’id de l’utilisateur à ajouter, appelle la fonction *addUser(projectId, userId)* du fichier **/repositories/projects.repository.js** puis redirige vers la page de ce projet. | - | US#13 | 0.5 | Abdelhadi | TODO |
| T_COLL_QU_V | Ajouter un bouton à la page “Accueil Projet” permettant de se retirer du projet. | Modifier le fichier **project.ejs** du répertoire */views/project/* pour ajouter un bouton “Quitter projet” affiche un message de confirmation, quand l'utilisateur clique dessus, on appelle la route */projects/:projectId/:userId* méthode DELETE, affiche un message. | - | US#14 | 0.5 | Abdelhadi | TODO |
| T_TSK_Mod | Créer le modèle pour la classe Task. | Créer le fichier **task.model.js** dans le répertoire */models/*. Ce fichier contient la définition de la classe Task, qui stocke les informations pour une tâche. (definition : https://gist.github.com/abdelhadinaimi/654914936fd8d7a23a9af17f3a0a272a)| - | US#20 | 0.5 | Abdelhadi | DONE |
| T_TSK_V | Créer la vue pour la page “Tâches”. | Créer le fichier **tasks.ejs** dans le répertoire */views/project/* qui correspond à la page “Tâches” du projet d’id *projectId*, affichée lorsqu’un utilisateur arrive sur l’URL */projects/:projectId/tasks/*.<br />Cette page importe le header **project-header.ejs** de */views/project/*.<br />En dessous de ce header, on trouve un titre “Tâches”, puis un bouton “Créer une tâche”, qui ouvre un modal à partir duquel on peut entrer les informations nécessaires à la création d’une tâche(cf. T_TSK_Mod).<br />En dessous de ces éléments, on trouve une collapsible list des tâches du projet, avec pour chaque entrée de la liste les attributs “Description” (3000 char max), “Definition of Done” (3000 char max), “Durée de réalisation” (0.5 J/h min), “Test” (lien vers le test). Créer la route **/project/:projectId/tasks** qui fait le rendu de cette vue | - | US#20,23,25 | 1 | Martin-Vigier | DOING |
| T_TSK_UPD_V | Ajouter un bouton à chaque tâche de la page “Tâche” permettant de modifier une tâche à la liste des tâches de la page “Tâches”. | Modifier le fichier **tasks.ejs** du répertoire */views/project/* pour ajouter un bouton “Modifier” à chaque entrée de la liste des tâches<br />En cliquant sur ce bouton, une page s'ouvre ; elle contient un formulaire comprenant exactement les mêmes champs que celui décrit à la tâche T_TSK_V, ainsi que deux boutons “Modifier” et “Annuler”.<br /> Cliquer sur le bouton “Modifier” appelle la route */projects/:projectId/tasks/:taskId* méthode PUT, tandis que cliquer sur “Annuler” redirige sur la page des tâches. | T_TSK_V | US#21 | 1 | Martin-Vigier | TODO |
| T_TSK_UPD_RpuC | Créer la route et la fonction permettant d’appliquer les modifications faites sur une tâche. | Créer la route **/project/:projectId/tasks/:taskId** dans le fichier **/routes/tasks.routes.js**, méthode PUT, créer la fonction *updateTask()* dans le contrôleur **/controllers/task.controller.js**, accepte un formulaire qui contient “description”, “definitionOfDone”, “cost”, ”testLink” (même validation que dans la vue), appelle la fonction *updateTask(projectId, task)* du fichier **/repositories/projects.repository.js**, si une erreur se passe, affiche l’erreur dans le formulaire. | - | US#21 | 1 | Latappy | TODO |
| T_TSK_DLT_V | Ajouter un bouton à chaque tâche de la page “Tâches” permettant de supprimer une tâche. | Modifier le fichier **tasks.ejs** du répertoire */views/project/* pour ajouter un bouton “Supprimer” à chaque entrée de la liste des tâches<br />En cliquant sur ce bouton, une fenêtre pop-up s’ouvre contenant le texte “Êtes-vous bien sûr de vouloir supprimer cette tâche ? Cette action est irréversible.” et deux boutons “Confirmer la suppression” et “Annuler”.<br />En cliquant sur le premier bouton de cette pop-up, la tâche est supprimé. et on appelle la route */projects/:projectId/tasks/:taskId* méthode DELETE. | T_TSK_V | US#22 | 0.5 | Martin-Vigier | TODO |
| T_TSK_DLT_RpuC | Créer la route et la fonction permettant de supprimer une tâche. | Créer la route **/project/:projectId/tasks/:taskId** dans le fichier **/routes/tasks.routes.js**, méthode DELETE. Puis créer la fonction *deleteTask()* dans le contrôleur **/controllers/task.controller.js** qui accepte un formulaire qui contient l’id de l’utilisateur à retirer, appelle la fonction deleteTask(taskId) du fichier **/repositories/projects.repository.js**. | - | US#22 | 0.5 | Martin-Vigier | TODO |
| T_TSK_FILTR_V | Ajouter un bouton à la page “Tâches” permettant de filtrer la liste des tâches pour n’afficher que les tâches auxquelles l’utilisateur est assigné. | Modifier le fichier **tasks.ejs** du répertoire */views/project/* pour ajouter un bouton “Mes tâches” au dessus de la collapsible list.<br />En cliquant sur ce bouton, les entrées de la liste n’étant pas assignées à l’utilisateur ne sont plus affichées. | T_TSK_V | US#24 | 0.5 | Latappy | TODO |
| T_TSK_STATE_V | Ajouter une liste déroulante à chaque tâche de la page “Tâches” pour changer son état. | Modifier le fichier **tasks.ejs** du répertoire */views/project/* pour ajouter une liste déroulante “État” à chaque entrée de la liste des tâches.<br />En cliquant sur ce menu, une liste contenant les entrées “TODO”, “DOING”, “DONE”, “TOTEST”, “TESTING”, “TESTED” s’affiche. En sélectionnant une de ces entrées, on change l’état de la tâche en question.<br />Modifier la route et le contrôleur. | T_TSK_V | US#28 | 0.5 | Abdelhadi | TODO |
| T_TSK_LINK_V | Ajouter une liste déroulante à chaque tâche de la page “Tâches” qui permet de lier une tâche à une ou plusieurs issues. | Modifier le fichier **tasks.ejs** du répertoire */views/project/* pour ajouter une liste déroulante qui contient toutes les issues du projet (sprint?) avec une checkbox devant chaque issue qui permet de choisir qu'elles issues à lier a la tâche.<br />Modifier la route et le contrôleur. | T_TSK_V | US#26 | 1 | Abdelhadi | TODO |
| T_TSK_ASSIGN_V | Ajouter une liste déroulante à chaque tâche de la page “Tâches” qui permet d'assigner une ou plusieurs personnes à une tâche. | Modifier le fichier **tasks.ejs** du répertoire */views/project/* pour ajouter une liste déroulante qui contient les contributeurs du projet avec une checkbox devant chaque personne. Cocher la checkbox d’un contributeur permet de l'assigner à la tâche.<br />Modifier la route et le contrôleur. | T_TSK_V | US#27 | 1 | Abdelhadi | TODO |
| TEST_TSK | Créer le fichier de test pour les tâches. | Créer le fichier **task.test.js** dans le répertoire */test/unit/* qui contient la batterie de tests à effectuer pour vérifier le bon fonctionnement des tâches.<br />Il doit comporter les tests suivants :<br />  \* ajout d’une tâche (réussite) :<br />  \* ajout d’une tâche (échec) ;<br />  \* mise-à-jour d’une tâche (réussite) ;<br />  \* mise-à-jour d’une tâche non-existante (échec) ;<br />  \* mise-à-jour d’une tâche par un utilisateur n’ayant pas les droits requis (échec) ;<br />  \* suppression d’une tâche (réussite). | - | - | 1 | Martin-Vigier | TODO |
| TEST_USR2 | Ajouter de nouveaux tests pour les utilisateurs. | Modifier le fichier **user.test.js** dans le répertoire */test/unit/* pour ajouter des tests vérifiant le bon fonctionnement des nouvelles fonctionnalités concernant les utilisateurs.<br />Les tests suivants doivent être ajoutés :<br />  \* mise-à-jour du nom d’utilisateur (réussite) ;<br />  \* mise-à-jour du nom d’utilisateur, le nouveau nom est déjà pris (échec). | - | - | 1 | Latappy | TODO |
| TEST_PRJ2 | Ajouter de nouveaux tests pour les projets. | Modifier le fichier **project.test.js** dans le répertoire */test/unit/* pour ajouter des tests vérifiant le bon fonctionnement des nouvelles fonctionnalités concernant les projets.<br />Les tests suivants doivent être ajoutés :<br />  \* mise-à-jour du rôle d’un collaborateur (réussite) ;<br />  \* suppression d’un collaborateur d’un projet (réussite). | - | - | 1 | Abdelhadi | TODO |
| TEST_US | Ajouter de nouveaux tests selinium. | Ajouter des tests selinium qui testent les USs | - | - | 1 | Latappy | TODO |
| Total | | | | 16.5<br />Abdelhadi : 7<br />Martin-Vigier : 5<br />Latappy : 5.5| | |
