<%- include('../partials/head.ejs') %> <%- include('../project/project-header.ejs') %>
<div class="row">
  <div class="col s12">
    <div class="row" style="margin: 10px 0 0 0">
      <div class="col s12 m10 offset-m1 l8 offset-l2">
        <div class="row valign-wrapper hide-on-small-only">
          <div class="col m4 offset-m4 center-align">
            <h5><%=pageTitle%></h5>
          </div>
          <div class="col m4 center-align">
            <a class="btn green modal-trigger" href="issues/add">Créer une issue</a>
          </div>
        </div>
        <div class="row valign-wrapper hide-on-med-and-up">
          <div class="col m4 offset-m4 center-align">
            <h5><%=pageTitle%></h5>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col s12 m10 offset-m1 l8 offset-l2">
      <div class="row card-content">
        <ul class="collapsible">
            <li class="collapsible-header">
                <div class="col s1 center"><strong>Identifiant</strong></div>
                <div class="col s8 center"><strong>Description</strong></div>
                <div class="col s1 center"><strong>Priorité</strong></div>
                <div class="col s1 center"><strong>Coût</strong></div>
                <div class="col s2 center"><strong>Complétion</strong></div>
          </li>
          <% project.issues.forEach( issue => { %>
          <li>
              <div class="collapsible-header line" tabindex="0">
                  <div class="col s1 center"><%=issue.storyId%></div>
                  <div class="col s8 center"><p class="userstory-header"><b>En tant que</b> <%= issue.userType %> <b>Je souhaite</b> <%= issue.userGoal %>
                    <b>Afin de</b> <%= issue.userReason %></p></div>
                  <div class="col s1 center"><%=issue.priority%></div>
                  <div class="col s1 center"><%=issue.cost%>1j/h</div>
                  <div class="col s2 center"><%=issue.completion%>20%</div>
              </div>
              <div class="collapsible-body">
                  <div class="row center-align hide-on-med-and-up">
                      <div class="col s4">
                        <a href="/projects/<%= project.id %>" class="btn-floating blue">
                          <i class="material-icons">remove_red_eye</i>
                        </a>
                      </div>
                      <% if (!project.deleteEdit) { %>
                      <div class="col s4">
                        <a href="/projects/<%= project.id %>/edit" class="btn-floating white">
                          <i class="material-icons black-text">edit</i>
                        </a>
                      </div>
                      <div class="col s4">
                        <a
                          href="#deleteProject"
                          _id="<%= project.id %>"
                          class="btn-floating red modal-trigger deleteButton"
                        >
                          <i class="material-icons">delete</i>
                        </a>
                      </div>
                      <% } %>
                    </div>
                    <div class="row">
                      <div class="col s12 m9 l10">
                        <div class="row">
                          <div class="row">
                              <div class="col s12 m8">
                                  <b>Story : </b><b>En tant que</b> <%= issue.userType %> <b>Je souhaite</b> <%= issue.userGoal %>
                    <b>Afin de</b> <%= issue.userReason %>
                              </div>
                              <div class="col s12 m8">
                                  <b>Sprint : </b>Sprint 5
                              </div>
                              <div class="col s12 m8">
                                  <b>Taches : </b>Tâche 1,Tâche 3,Tâche 5
                              </div>
                          </div>
                        </div>
                      </div>
                      <div class="col s12 m3 l2 center-align hide-on-small-only">
                          <% if (!project.deleteEdit) { %>
                              <div class="row">
                                  <a href="issues/<%=issue.storyId%>/edit"
                                    class="btn white black-text"
                                    style="width: 100%">Modifier</a>
                              </div>
                              <div class="row">
                                  <a href="#deleteIssue" class="btn red modal-trigger deleteButton"
                                    _id="<%= issue.id %>" style="width: 100%">Supprimer</a>
                              </div>
                          <% } %>
                      </div>
                    </div>
              </div>
          </li>
          <% }) %>
        </ul>
    </div>
    </div>
  </div>
</div>

<%- include('../partials/scripts.ejs') %> <%- include('../partials/toast.ejs') %> <%-
include('../partials/menu-connected-script.ejs') %>
<script>
  $(document).ready(function() {
    $('.collapsible').collapsible();    
      $(".modal").modal();
    $(".dropdown-trigger").dropdown();
    $(".sidenav").sidenav();
  });
</script>
<style>

.userstory-header {
  white-space: nowrap;
  width: 300px;
  overflow: hidden;
  text-overflow: ellipsis;
  margin: auto;
}

</style>